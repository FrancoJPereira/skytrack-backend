generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}



enum UserRole {
  ADMIN
  OPERADOR
}

enum PlaneStatus {
  DISPONIBLE
  EN_VUELO
  MANTENIMIENTO
}

enum FlightStatus {
  PROGRAMADO
  EMBARCANDO
  EN_VUELO
  ATERRIZADO
  CANCELADO
}

model User {
  id        Int      @id @default(autoincrement())
  username  String   @unique
  password  String
  role      UserRole
}

model Plane {
  id           Int         @id @default(autoincrement())
  model        String
  registration String      @unique
  status       PlaneStatus @default(DISPONIBLE)
  flights      Flight[]
}

model Flight {
  id            Int           @id @default(autoincrement())
  code          String        @unique
  origin        String
  destination   String
  departureTime DateTime
  arrivalTime   DateTime
  status        FlightStatus  @default(PROGRAMADO)
  planeId       Int?
  plane         Plane?        @relation(fields: [planeId], references: [id])
  crew          FlightCrew[]
  deletedAt     DateTime?
}

model CrewMember {
  id        Int          @id @default(autoincrement())
  fullName  String
  role      String
  flights   FlightCrew[]
  deletedAt DateTime?
}


model FlightCrew {
  id           Int        @id @default(autoincrement())
  flightId     Int
  crewMemberId Int
  flight       Flight     @relation(fields: [flightId], references: [id])
  crewMember   CrewMember @relation(fields: [crewMemberId], references: [id])

  @@unique([flightId, crewMemberId])
}
